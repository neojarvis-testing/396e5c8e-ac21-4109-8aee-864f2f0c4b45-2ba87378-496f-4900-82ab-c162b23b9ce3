<app-seller-navbar></app-seller-navbar>
<div class="container mt-4" style="max-width: 900px;">
  <h1 class="mb-4">Chemical Requests for Approval</h1>

  <div class="d-flex justify-content-between mb-3">
    <input type="text" class="form-control me-2" placeholder="Search by chemical name"
           [(ngModel)]="searchTerm" (input)="applyFilters()" />
    <select class="form-select w-auto" [(ngModel)]="statusFilter" (change)="applyFilters()">
      <option value="">All Status</option>
      <option value="Pending">Pending</option>
      <option value="Approved">Approved</option>
      <option value="Rejected">Rejected</option>
    </select>
  </div>

  <div *ngIf="filteredRequests.length === 0" class="text-center text-muted mt-5">
    <p>Oops! No records Found</p>
  </div>

  <table *ngIf="filteredRequests.length > 0" class="table table-bordered table-hover">
    <thead class="table-light">
      <tr>
        <th>Chemical Name</th>
        <th>Farmer Name</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let req of filteredRequests">
        <td>{{ req.chemicalName }}</td>
        <td>{{ req.farmerName }}</td>
        <td>{{ req.status }}</td>
        <td>
          <button class="btn btn-info btn-sm me-2" (click)="openDetails(req)">Show More</button>
          <button class="btn btn-success btn-sm me-1" (click)="updateStatus(req, 'Approved')">Approve</button>
          <button class="btn btn-danger btn-sm" (click)="updateStatus(req, 'Rejected')">Reject</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Request Details Modal -->
  <div class="modal fade show d-block" *ngIf="selectedRequest" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content p-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5>Request Details</h5>
          <button class="btn-close" (click)="closeDetails()"></button>
        </div>
        <p><strong>Chemical:</strong> {{ selectedRequest.chemicalName }}</p>
        <p><strong>Farmer:</strong> {{ selectedRequest.farmerName }}</p>
        <p><strong>Quantity:</strong> {{ selectedRequest.quantity }}</p>
        <p><strong>Status:</strong> {{ selectedRequest.status }}</p>
        <p><strong>Requested On:</strong> {{ selectedRequest.date | date }}</p>
      </div>
    </div>
  </div>
